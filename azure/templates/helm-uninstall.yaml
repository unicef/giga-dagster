jobs:
  - deployment: Deploy
    displayName: Uninstall all Helm charts
    environment: $(kubernetesEnvironment)
    strategy:
      runOnce:
        deploy:
          steps:
            - task: HelmDeploy@0
              displayName: Helm uninstall nginx
              inputs:
                namespace: $(kubernetesNamespace)
                command: uninstall
                arguments: nginx

            - task: HelmDeploy@0
              displayName: Helm uninstall auth proxy
              inputs:
                namespace: $(kubernetesNamespace)
                command: uninstall
                arguments: dagster-authproxy

            - task: HelmDeploy@0
              displayName: Helm uninstall Dagster
              inputs:
                namespace: $(kubernetesNamespace)
                command: uninstall
                arguments: dagster

            - task: HelmDeploy@0
              displayName: Helm uninstall Hive Metastore
              inputs:
                namespace: $(kubernetesNamespace)
                command: uninstall
                arguments: hive-metastore

            - task: HelmDeploy@0
              displayName: Helm uninstall Spark
              inputs:
                namespace: $(kubernetesNamespace)
                command: uninstall
                arguments: spark
